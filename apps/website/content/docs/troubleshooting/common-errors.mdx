---
title: Common Errors
description: Database locks, port conflicts, installation issues, and other common problems
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { AgentCmd } from '@/components/AgentCmd';

## Overview

This guide covers the most common errors you'll encounter when developing with <AgentCmd /> and how to fix them quickly.

## Installation Issues

### Missing Dependencies

**Symptoms**:
- `command not found: agentcmd`
- `Cannot find module 'sqlite3'`
- Node version errors

**Diagnosis**:
```bash
# Check Node version (requires 18+)
node --version

# Check if agentcmd is installed
which agentcmd

# Verify SQLite installation
sqlite3 --version
```

**Solution**:
```bash
# Install Node 18+ via nvm
nvm install 18
nvm use 18

# Reinstall agentcmd globally
npm install -g agentcmd

# Or use without installing
npx agentcmd install
```

**Prevention**:
- Use Node 18 or higher
- Run `npx agentcmd` if global install fails
- Check system requirements before installation

---

### Installation Hangs or Times Out

**Symptoms**:
- `npm install` hangs indefinitely
- Network timeout errors during install
- Incomplete installation

**Diagnosis**:
```bash
# Check npm registry connectivity
npm ping

# Verify network settings
npm config get registry

# Check for proxy issues
npm config get proxy
npm config get https-proxy
```

**Solution**:
```bash
# Clear npm cache
npm cache clean --force

# Use different registry if needed
npm config set registry https://registry.npmjs.org/

# Retry installation with verbose logging
npm install -g agentcmd --verbose

# If behind proxy, configure:
npm config set proxy http://proxy.company.com:8080
npm config set https-proxy http://proxy.company.com:8080
```

**Prevention**:
- Ensure stable internet connection
- Configure proxy settings before install
- Use `pnpm` or `yarn` as alternatives

---

## Port Conflicts

### Port Already in Use

**Symptoms**:
- `Error: listen EADDRINUSE: address already in use :::3456`
- `Error: listen EADDRINUSE: address already in use :::5173`
- `Error: listen EADDRINUSE: address already in use :::8288`

**Diagnosis**:
```bash
# Find process using backend port (3456)
lsof -i :3456

# Find process using frontend port (5173)
lsof -i :5173

# Find process using Inngest port (8288)
lsof -i :8288

# On Windows:
netstat -ano | findstr :3456
```

**Solution**:

<Tabs items={['Kill Specific Process', 'Kill All Node', 'Use Different Ports']}>
  <Tab value="Kill Specific Process">
    ```bash
    # Kill specific process by PID
    kill -9 <PID>

    # Example: if lsof shows PID 12345
    kill -9 12345

    # Restart AgentCmd
    pnpm dev
    ```
  </Tab>

  <Tab value="Kill All Node">
    ```bash
    # Kill all node processes (nuclear option)
    pkill node

    # Or on Windows:
    taskkill /F /IM node.exe

    # Restart AgentCmd
    pnpm dev
    ```
  </Tab>

  <Tab value="Use Different Ports">
    ```bash
    # Set custom ports via environment variables
    # In apps/app/.env
    PORT=3500
    VITE_PORT=5200
    INNGEST_PORT=8300

    # Or via command line
    PORT=3500 pnpm dev
    ```
  </Tab>
</Tabs>

**Prevention**:
- Always stop dev server with Ctrl+C before closing terminal
- Use process managers like PM2 for better control
- Create shell aliases for cleanup commands

---

### Cannot Connect to Server

**Symptoms**:
- `ECONNREFUSED 127.0.0.1:3456`
- Frontend can't reach backend
- API requests fail with network errors

**Diagnosis**:
```bash
# Check if backend is running
curl http://localhost:3456/api/health

# Should return: {"status":"ok"}

# Check processes
ps aux | grep node

# Verify ports are listening
lsof -i :3456 -i :5173
```

**Solution**:
```bash
# Start backend explicitly
cd apps/app
pnpm dev:server

# In another terminal, start frontend
pnpm dev:client

# Or start both together
pnpm dev

# Check logs for startup errors
tail -f apps/app/logs/app.log
```

<Callout type="warn">
**Firewall Issues**: If running in Docker or VM, ensure ports 3456, 5173, and 8288 are exposed and not blocked by firewall.
</Callout>

**Prevention**:
- Always run `pnpm dev` from `apps/app/` directory
- Check logs immediately after startup
- Verify `.env` file exists with correct configuration

---

## Database Errors

### Database Is Locked

**Symptoms**:
- `Error: SQLITE_BUSY: database is locked`
- Write operations fail
- Timeout on database queries

**Diagnosis**:
```bash
# Check for multiple node processes
ps aux | grep node

# Check database file access
lsof apps/app/prisma/dev.db

# Verify database integrity
sqlite3 apps/app/prisma/dev.db "PRAGMA integrity_check;"
```

**Solution**:

<Tabs items={['Kill Processes', 'Reset Database', 'Emergency Recovery']}>
  <Tab value="Kill Processes">
    ```bash
    # Kill all node processes
    pkill node

    # Remove any .db-journal files
    rm apps/app/prisma/dev.db-journal

    # Restart server
    pnpm dev
    ```
  </Tab>

  <Tab value="Reset Database">
    ```bash
    # Backup current database (optional)
    cp apps/app/prisma/dev.db apps/app/prisma/dev.db.backup

    # Reset database (destructive!)
    cd apps/app
    pnpm prisma:reset

    # Restart server
    pnpm dev
    ```
  </Tab>

  <Tab value="Emergency Recovery">
    ```bash
    # Complete nuclear option
    pkill node
    rm apps/app/prisma/dev.db
    rm apps/app/prisma/dev.db-journal
    cd apps/app
    pnpm prisma migrate deploy
    pnpm dev
    ```
  </Tab>
</Tabs>

**Prevention**:
- Never run multiple instances of the server
- Use `pnpm dev` instead of manual server starts
- Implement connection pooling for production
- Enable WAL mode for better concurrency (see Database Guide)

---

### Migration Errors

**Symptoms**:
- `Migration failed to apply`
- `Foreign key constraint failed`
- Schema and database out of sync

**Diagnosis**:
```bash
# Check migration status
cd apps/app
pnpm prisma migrate status

# Inspect latest migration
ls -la prisma/migrations/
cat prisma/migrations/<latest>/migration.sql
```

**Solution**:
```bash
# If in development, reset database
pnpm prisma migrate reset

# If in production, create fixup migration
pnpm prisma migrate deploy

# If migration conflict after git pull
# 1. Reset database
pnpm prisma migrate reset

# 2. Or manually resolve conflicts
# Edit prisma/migrations/...
pnpm prisma migrate resolve --applied <migration-name>
pnpm prisma migrate deploy
```

<Callout type="error">
**Production Warning**: Never use `prisma migrate reset` in production. Use `prisma migrate deploy` only.
</Callout>

**Prevention**:
- Always pull latest migrations before creating new ones
- Test migrations in dev before deploying
- Use `prisma migrate dev` (creates and applies)
- Coordinate with team on schema changes

---

### Prisma Client Out of Sync

**Symptoms**:
- `Property does not exist on type`
- TypeScript errors after schema changes
- Runtime errors: "Invalid prisma.model invocation"

**Diagnosis**:
```bash
# Check if schema and client match
cd apps/app
pnpm prisma validate

# Check Prisma client generation status
ls -la node_modules/.prisma/client/
```

**Solution**:
```bash
# Regenerate Prisma client
pnpm prisma:generate

# If issues persist, clear and rebuild
rm -rf node_modules/.prisma
rm -rf node_modules/@prisma
pnpm install
pnpm prisma:generate

# Restart TypeScript server in IDE
# VS Code: Cmd+Shift+P â†’ "TypeScript: Restart TS Server"
```

**Prevention**:
- Run `pnpm prisma:generate` after every schema change
- Add pre-commit hook to generate client
- Use `pnpm dev` which auto-runs migrations

---

## Permission Errors

### EACCES: Permission Denied

**Symptoms**:
- `Error: EACCES: permission denied`
- Cannot write to log files
- Cannot create database file

**Diagnosis**:
```bash
# Check file permissions
ls -la apps/app/logs/
ls -la apps/app/prisma/

# Check directory ownership
ls -la apps/app/
```

**Solution**:
```bash
# Fix file permissions
chmod -R 755 apps/app/logs
chmod -R 755 apps/app/prisma

# Fix ownership (if needed)
sudo chown -R $USER:$USER apps/app/

# On Windows, run terminal as Administrator
```

<Callout type="info">
**Docker Users**: Permission issues in containers often require mapping UID/GID. See deployment documentation.
</Callout>

**Prevention**:
- Don't run development server with `sudo`
- Ensure correct ownership of project directory
- Configure proper permissions in CI/CD

---

## Build Errors

### TypeScript Type Errors

**Symptoms**:
- `Type 'X' is not assignable to type 'Y'`
- Build fails with type checking errors
- IDE shows red squiggles

**Diagnosis**:
```bash
# Run type checker
cd apps/app
pnpm check-types

# Check TypeScript version
pnpm list typescript

# Verify tsconfig
cat tsconfig.json
```

**Solution**:
```bash
# Clear TypeScript cache
rm -rf node_modules/.cache
rm -rf apps/app/dist

# Regenerate Prisma client (often the culprit)
pnpm prisma:generate

# Reinstall dependencies
rm -rf node_modules
pnpm install

# Check types again
pnpm check-types

# Restart TS server in IDE
```

<Callout type="warn">
**Common Issue**: Mixing `null` and `undefined`. Database fields use `null`, React props use `undefined`. Don't mix them.
</Callout>

**Prevention**:
- Follow type conventions (see CLAUDE.md)
- Use `@/` path aliases, not relative imports
- Import types at top-level, not inline
- Run `check-types` before committing

---

### Module Not Found

**Symptoms**:
- `Cannot find module '@/server/...'`
- `Module not found: Error: Can't resolve`
- Import errors at runtime or build

**Diagnosis**:
```bash
# Check tsconfig path mappings
cat apps/app/tsconfig.json | grep paths

# Verify file exists
ls apps/app/src/server/domain/...

# Check for typos in import
grep -r "import.*from.*@/" apps/app/src/
```

**Solution**:
```bash
# Rebuild from scratch
rm -rf node_modules dist
pnpm install
pnpm build

# Verify path aliases in tsconfig.json
# Should have:
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}

# Restart dev server
pnpm dev
```

**Prevention**:
- Always use `@/` aliases for imports
- Never use relative paths like `../../../`
- Never add `.js` or `.ts` extensions to imports
- Follow import conventions in CLAUDE.md

---

### Vite Build Errors

**Symptoms**:
- `Unexpected token` in Vite build
- `[plugin:vite] Rollup failed to resolve`
- Build hangs or crashes

**Diagnosis**:
```bash
# Check Vite cache
ls -la node_modules/.vite

# Build with debug info
pnpm build --debug

# Check for circular dependencies
npx madge --circular apps/app/src/
```

**Solution**:
```bash
# Clear Vite cache
rm -rf node_modules/.vite
rm -rf apps/app/dist

# Rebuild
pnpm build

# If issue persists, clear everything
rm -rf node_modules
pnpm install
pnpm build
```

**Prevention**:
- Avoid circular dependencies
- Keep component tree shallow
- Use dynamic imports for large dependencies
- Follow frontend patterns (see apps/app/src/client/CLAUDE.md)

---

## Hot Reload Issues

### Changes Not Reflecting

**Symptoms**:
- File changes don't trigger reload
- Browser shows stale code
- Server doesn't restart on file save

**Diagnosis**:
```bash
# Check if dev server is running
ps aux | grep vite
ps aux | grep tsx

# Verify file watcher limits (Linux)
cat /proc/sys/fs/inotify/max_user_watches
```

**Solution**:
```bash
# Restart dev server
# Ctrl+C, then:
pnpm dev

# Hard refresh browser
# Mac: Cmd+Shift+R
# Windows: Ctrl+Shift+R

# Clear Vite cache
rm -rf node_modules/.vite

# Increase file watcher limit (Linux)
echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

**Prevention**:
- Don't edit files in `dist/` or `node_modules/`
- Save files properly (not temp autosave)
- Close other apps watching same files
- Use supported editors (VS Code, Cursor, etc.)

---

## Environment Variable Issues

### Missing Required Variables

**Symptoms**:
- `JWT_SECRET is required`
- `DATABASE_URL is required`
- Server fails to start with config error

**Diagnosis**:
```bash
# Check if .env exists
ls -la apps/app/.env

# Verify environment variables
cd apps/app
node -e "require('dotenv').config(); console.log(process.env.JWT_SECRET)"
```

**Solution**:
```bash
# Create .env from template
cd apps/app
cp .env.example .env

# Generate JWT secret
openssl rand -base64 32

# Add to .env:
echo "JWT_SECRET=$(openssl rand -base64 32)" >> .env
echo "DATABASE_URL=file:./prisma/dev.db" >> .env

# Restart server
pnpm dev
```

<Callout type="error">
**Security**: Never commit `.env` files. Always use `.env.example` as template.
</Callout>

**Prevention**:
- Always create `.env` file before first run
- Keep `.env.example` updated with new variables
- Document required vs optional variables
- Use config validation at startup

---

## Quick Fixes Cheat Sheet

```bash
# Database locked
pkill node && pnpm dev

# Type errors
pnpm prisma:generate && pnpm check-types

# Build fails
rm -rf node_modules dist && pnpm install && pnpm build

# Hot reload broken
rm -rf node_modules/.vite && pnpm dev

# Port in use
lsof -i :3456 | grep node | awk '{print $2}' | xargs kill -9

# Migration conflict
pnpm prisma migrate reset

# Everything broken (nuclear option)
pkill node && rm -rf node_modules dist apps/app/prisma/dev.db && pnpm install && pnpm prisma migrate deploy && pnpm dev
```

## Next Steps

- [Workflow Failures](/docs/troubleshooting/workflow-failures) - Debug workflow execution issues
- [Connection Problems](/docs/troubleshooting/connection-problems) - WebSocket and Inngest issues
- [Backend Patterns](/.agent/docs/backend-patterns.md) - Deep dive into backend architecture
