# agentcmd

> AI agent workflow management platform with chat, file editing, and terminal capabilities

## Why agentcmd?

I was sick of babysitting my agents. Love Claude Code. Hate babysitting. Like a good AI Engineer I called "/plan", then "/implement", then "/review" until my fingers were blue. Then I got to work on agentcmd.

**agentcmd lets you:**

- Chain slash commands into recursive workflows that run until done
- Define workflwos in code. Bring your tools, your process, your slash commands
- Add any steps you want: security checks, code reviews, multiple agents reviewing each other
- Run in isolated Worktress so nothing conflicts
- Fully responsive, so you can code from anywhere (after you setup Tailscale)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue.svg)](https://www.typescriptlang.org/)
[![pnpm](https://img.shields.io/badge/pnpm-8.0+-orange.svg)](https://pnpm.io/)

Full-stack web application for orchestrating AI agent workflows. Interact with Claude Code and OpenAI Codex through a modern interface with real-time chat, file editing, and integrated terminal.

## Features

- **Multi-Agent Chat** - Interact with Claude Code, OpenAI Codex, and other AI agents
- **Real-Time File Editor** - Syntax highlighting, auto-save, collaborative editing
- **Integrated Terminal** - Full terminal access with WebSocket streaming
- **Session Management** - Save, resume, and organize agent conversations
- **Git Integration** - Commit, branch, and PR creation from the interface
- **Project Workspaces** - Manage multiple projects with isolated environments
- **Workflow Engine** - Orchestrate multi-step AI workflows with Inngest
- **Slash Commands** - Extend agent capabilities with custom commands

## Example Workflow

```typescript
import { defineWorkflow, step } from "agentcmd-workflows";

export default defineWorkflow({
  name: "code-review",
  description: "Automated code review with Claude",
  steps: [
    step.agent({
      name: "analyze",
      prompt: "Review this code for bugs and improvements",
      agent: "claude-code",
    }),
    step.conditional({
      name: "check-severity",
      condition: (ctx) => ctx.results.analyze.issues.length > 0,
      onTrue: step.agent({
        name: "fix",
        prompt: "Fix the identified issues",
        agent: "claude-code",
      }),
    }),
  ],
});
```

See the [First Workflow Guide](https://agentcmd.dev/docs/getting-started/first-workflow) for a complete tutorial.

## Getting Started

Install and run as standalone application:

```bash
# First-time setup (creates ~/.agentcmd/)
npx agentcmd install

# Start server - Access at http://localhost:4100
npx agentcmd start

# Customize ports
npx agentcmd start --port 8080 --inngest-port 9000

# Manage configuration
npx agentcmd config --show
npx agentcmd config --set port=7000
```

### Development

Clone and run in development mode with hot reload:

```bash
# Clone and install
git clone https://github.com/jnarowski/agentcmd.git
cd agentcmd
pnpm install

# Setup database and environment
pnpm dev:setup

# Start Turborepo
pnpm dev
```

**Access at:**

- Frontend: [http://localhost:4101](http://localhost:4101)
- Backend: [http://localhost:4100](http://localhost:4100)
- Inngest UI: [http://localhost:8288](http://localhost:8288)

### For Production (pm2)

Run optimized builds locally with process management:

```bash
# Build and start
pnpm build
pm2 start ecosystem.config.js
```

Config stored in `~/.agentcmd/config.json` with auto-generated JWT secret and database.

## Configuration

### Environment Variables

**For development and production (pnpm/pm2):**

Add your API key to `apps/app/.env`:

```bash
ANTHROPIC_API_KEY=your-api-key-here
```

All other variables are auto-generated by `pnpm dev:setup`. See `apps/app/.env.example` for full options.

**For CLI tool (npx agentcmd):**

```bash
npx agentcmd config --set anthropicApiKey=your-api-key-here
```

Or manually edit `~/.agentcmd/config.json`.

### Ports

| Service         | Default | Configure Via                                                                  |
| --------------- | ------- | ------------------------------------------------------------------------------ |
| Fastify Server  | 4100    | `PORT` env var or `--port` flag                                                |
| Vite Dev Server | 4101    | `VITE_PORT` env var (dev only)                                                 |
| Inngest Dev UI  | 8288    | `inngestPort` in config.json, `INNGEST_PORT` env var, or `--inngest-port` flag |

**Priority:** CLI flags > config.json > .env > defaults

## Common Commands

```bash
# Development
pnpm dev              # Start dev server (from apps/app/)
pnpm build            # Build all packages (from root)
pnpm test             # Run tests
pnpm lint             # Lint code
pnpm check-types      # Type check

# Database
pnpm prisma:migrate   # Run migrations (from apps/app/)
pnpm prisma:studio    # Open database GUI

# Troubleshooting
pnpm dev:kill         # Kill dev processes (from apps/app/)
```

## Project Structure

This is a Turborepo monorepo containing:

- **`apps/app`** - Full-stack application (React + Fastify)
  - Domain-driven backend architecture
  - WebSocket support for real-time features
  - Inngest workflow engine integration

- **`packages/agent-cli-sdk`** - SDK for AI CLI tools (Claude, Codex)
- **`packages/agentcmd-workflows`** - Workflow orchestration library

## Documentation

Full documentation available at **[agentcmd.dev/docs](https://agentcmd.dev/docs)**

## Common Issues

| Issue            | Solution                                                     |
| ---------------- | ------------------------------------------------------------ |
| Module not found | Run `pnpm build` from root                                   |
| Database errors  | `cd apps/app && pnpm prisma:generate && pnpm prisma:migrate` |
| WebSocket issues | Check logs: `tail -f apps/app/logs/app.log`                  |
| Port conflicts   | `cd apps/app && pnpm dev:kill && pnpm dev`                   |
| Build failures   | `rm -rf packages/*/dist apps/*/dist && pnpm build`           |

## Tech Stack

**Frontend:** React 19, Vite, TanStack Query, Zustand, Tailwind v4, shadcn/ui, CodeMirror, xterm.js
**Backend:** Fastify, Prisma (SQLite), JWT, WebSocket, node-pty, Inngest
**Build:** Turborepo, pnpm, TypeScript (strict mode)

## Contributing

1. Fork and create a feature branch
2. Make changes following code style (`pnpm lint` and `pnpm check-types`)
3. Write tests for new features
4. Submit a PR with clear description

See [CLAUDE.md](./CLAUDE.md) for detailed development guidelines.

## License

MIT License - see [LICENSE](LICENSE) for details
